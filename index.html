<html>
<head>
    <title>strata ~ home</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="favicon.ico" rel="icon" type="image/x-icon" />
    <link href="/css/style.css" rel="stylesheet">
</head>
<body>
    <div id='tools'>
        <a href='#' id='new'>new</a> |
        <a href='#' id='share'>share</a> |
        <a href='#' id='download' download='strata-download.txt'>download text</a> |
        <a href='https://github.com/0i8/strata' target='_blank'>source</a>

        <input id='urlInput'>
    </div>
    <textarea spellcheck="false" id="t">strata is a pastebin that never sees the contents of its pastes!

- click "new" to create your own paste
- click "source" to find out more about this

--

jupiter (s@turn.moe)</textarea>
    <script language="javascript" src="js/lz-string.min.js"></script>
    <script>
        var f;
        var textarea = document.getElementById("t");
        var urlInput = document.getElementById("urlInput");
        var download = document.getElementById('download');

        var content = LZString.decompressFromBase64(window.location.hash.slice(1));
        if (content) {
        textarea.value = content;
        }

        processContent(); // update urlInput and download link

        function processContent() {
        window.location.hash = hash();
        urlInput.value = window.location;
        document.title = title();
        download.setAttribute("download", filename());
        download.href = downloadUri();
        }

        function hash() {
        return LZString.compressToBase64(textarea.value);
        }

        function title() {
        return textarea.value ? textarea.value.slice(0, 30) : "strata";
        }

        function filename() {
        return title().replace(/[^a-z0-9]/gi, "_").toLowerCase() + "_strata.txt";
        }

        function downloadUri() {
        return "data:text/plain," + encodeURIComponent(textarea.value);
        }

        function contentChanged() {
        clearInterval(f);
        f = setTimeout(function () {
            processContent();
        }, 500);
        }

        function share() {
        urlInput.style.display = "block";
        urlInput.select();
        return false;
        }

        function unshare() {
        urlInput.style.display = "none";
        }

        function clear() {
        textarea.value = "";
        unshare();
        textarea.focus();
        processContent();
        return false;
        }

        textarea.onkeyup = contentChanged;
        textarea.onpaste = contentChanged;
        textarea.onfocus = unshare;
        document.getElementById("share").onclick = share;
        document.getElementById("new").onclick = clear;
    </script>
</body>
</html>
